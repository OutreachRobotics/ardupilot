
// del_helper.h

#ifndef DEL_HELPER_H
#define DEL_HELPER_H

/***************************************************************************
    Include headers :
***************************************************************************/



/***************************************************************************
    Macro :
***************************************************************************/

// MODE ///////////////////////////////////////////////////////////////////
#define MAX_RC_INPUT                        100.0f
#define MID_RC_INPUT                        50.0f
#define MID_PPM_VALUE                       1500
#define LOW_PPM_VALUE                       1000

// RANGEFINDER ///////////////////////////////////////////////////////////
#define RANGEFINDER_OFFSET                  0.45f

// RC CHANNEL ////////////////////////////////////////////////////////////
#define SEQUENCE_CHANNEL                    CH_12
#define STEALTH_CHANNEL                     CH_11
#define TAXI_CHANNEL                        CH_13
#define CALIB_CHANNEL                       CH_15
#define WRIST_CHANNEL                       CH_14

// ATTITUDE CONTROL //////////////////////////////////////////////////////
#define YAW_SENSITIVITY                     0.01f
#define ROLL_SENSITIVITY                    0.003f
#define PITCH_SENSITIVITY                   0.003f
#define PMAX_ACTUATOR_THRUST                14.0f
#define RMAX_ACTUATOR_THRUST                (13.0f*(ROLL_ADJUSTMENT+1.0f)/2.0f)
#define M_PLATFORM                          3.64f
#define MAX_PITCH                           0.305f // 17.5Â°
#define MAX_ROLL                            (MAX_PITCH*(1.0f+ROLL_ADJUSTMENT)/2.0f)
#define MIN_PITCH                           (-MAX_PITCH)
#define MIN_ROLL                            (-MAX_ROLL)
#define DEADBAND                            0.02f

// FILTER COEFFICIENTS //////////////////////////////////////////////////////
// Low pass filter coefficient fc = 15 Hz, Fs = 50 Hz
#define B1_LP                               0.5792
#define B0_LP                               0.5792
#define A0_LP                               0.1584
// Low pass filter coefficient fc = 25 Hz, Fs = 400 Hz
#define B1_DS                               0.1659
#define B0_DS                               0.1659
#define A0_DS                               -0.6682
// Low pass filter coefficient fc = 1 Hz, Fs = 50 Hz
#define B1_SP                               0.0592
#define B0_SP                               0.0592
#define A0_SP                               -0.8816
// Low pass filter coefficient fc = 1 Hz, Fs = 50 Hz
#define LPF_RANGE_B                         0.0592
#define LPF_RANGE_A                         0.8816

// PD GAIN ///////////////////////////////////////////////////////////////////
#define YAW_KP                              20.0f
#define YAW_KD                              12.0f
#define ROLL_KP                             28.0f
#define ROLL_KD                             46.0f
#define PITCH_KP                            50.0f
#define PITCH_KD                            50.0f

// MOTOR //////////////////////////////////////////////////////////////////////
#define T2PWM_COEF1                         -2.2435f
#define T2PWM_COEF2                         103.52f
#define T2PWM_COEF3                         1177.4f
#define ROLL_ADJUSTMENT                     0.37f
#define MOTOR_MAX_PPM                       1800
#define MOTOR_MIN_PPM                       1150
#define MOTOR_TF_B                          0.1582
#define MOTOR_TF_A                          0.6835

// EKF CONSTANT ////////////////////////////////////////////////////////////////
#define EYE_2                               {1,0,0,1}
#define EYE_4                               {1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1}
#define P_INI_2                             {1,0,0,1}
#define P_INI_4                             {1000,0,0,0,0,1000,0,0,0,0,1000,0,0,0,0,1000}
#define C_YAW                               {1,0}
#define C_ROLL                              {0,0,1,0,0,0,0,1}
#define C_PITCH                             {0,0,1,0,0,0,0,1}

// EKF TUNING ///////////////////////////////////////////////////////////////////
#define R_ROLL                              {0.1f,0,0,1e-4}
#define R_PITCH                             {0.1f,0,0,1e-4}
#define R_YAW_GYRO                          0.1f

#define TS                                  (1/400.0f)

#define K_LQR_TAXI                          {-0.0000,-0.0000,0.0000,0.0000,9.1023,10.6138,33.0339,-11.7028,0.0000,0.0000,-9.5826,-68.3837,-33.1381,68.7290,-0.0000,0.0000,-0.0000,-0.0000,0.0000,0.0000,0.000000,0.000000,0.000000,0.000000,-0.000000,-0.000000,-0.000000,-0.000000,15.827118,64.039825} 

#define F_ROLL_6M                           {0.999553,-0.357855,0.000439,0.351230,0.002500,0.999553,0.000000,0.000439,0.000826,0.660914,0.999174,-0.660916,0.000001,0.000826,0.002499,0.999174}
#define F_PITCH_6M                          {0.999852,-0.118002,0.000139,0.111376,0.002500,0.999852,0.000000,0.000139,0.000262,0.209578,0.999738,-0.209578,0.000000,0.000262,0.002500,0.999738}
#define F_YAW_6M                            {1.000000,0.000000,0.002500,1.000000}
#define B_ROLL_6M                           {0.006903,0.000000,0.129868,0.000000}
#define B_PITCH_6M                          {-0.010867,0.000000,0.163306,0.000000}
#define B_YAW_6M                            {1.942125,0.000000}
#define K_LQR_6M                            {0.000000,0.000000,0.000000,0.000000,65.628005,128.624906,60.277595,241.652402,-0.000000,-0.000000,-69.598605,-218.873665,-53.880482,-162.008795,-0.000000,-0.000000,-0.000000,-0.000000,-0.000000,-0.000000,0.000000,0.000000,0.000000,0.000000,-0.000000,-0.000000,-0.000000,-0.000000,15.827118,64.039825}

#define F_ROLL_10M                          {0.999793,-0.165521,0.000203,0.162457,0.002500,0.999793,0.000000,0.000203,0.000826,0.660967,0.999174,-0.660968,0.000001,0.000826,0.002499,0.999174}
#define F_PITCH_10M                         {0.999932,-0.054577,0.000064,0.051513,0.002500,0.999932,0.000000,0.000064,0.000262,0.209583,0.999738,-0.209584,0.000000,0.000262,0.002500,0.999738}
#define F_YAW_10M                           {1.000000,0.000000,0.002500,1.000000}
#define B_ROLL_10M                          {0.003193,0.000000,0.129868,0.000000}
#define B_PITCH_10M                         {-0.005026,0.000000,0.163306,0.000000}
#define B_YAW_10M                           {1.942125,0.000000}
#define K_LQR_10M                           {0.000000,0.000000,0.000000,0.000000,108.152407,193.429110,53.073776,185.337092,-0.000000,-0.000000,-116.748013,-284.042192,-45.783551,-103.085713,0.000000,0.000000,0.000000,0.000000,-0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,-0.000000,-0.000000,-0.000000,-0.000000,15.827118,64.039825}

#define F_ROLL_15M                          {0.999873,-0.101862,0.000125,0.099976,0.002500,0.999873,0.000000,0.000125,0.000826,0.660984,0.999174,-0.660985,0.000001,0.000826,0.002499,0.999174}
#define F_PITCH_15M                         {0.999958,-0.033586,0.000040,0.031700,0.002500,0.999958,0.000000,0.000040,0.000262,0.209585,0.999738,-0.209585,0.000000,0.000262,0.002500,0.999738}
#define F_YAW_15M                           {1.000000,0.000000,0.002500,1.000000}
#define B_ROLL_15M                          {0.001965,0.000000,0.129868,0.000000}
#define B_PITCH_15M                         {-0.003093,0.000000,0.163306,0.000000}
#define B_YAW_15M                           {1.942125,0.000000}
#define K_LQR_15M                           {-0.000000,-0.000000,-0.000000,-0.000000,143.493861,224.817840,49.329376,158.164849,-0.000000,-0.000000,-156.826423,-317.108500,-41.268237,-73.467628,0.000000,0.000000,0.000000,0.000000,-0.000000,-0.000000,0.000000,0.000000,0.000000,0.000000,-0.000000,-0.000000,-0.000000,-0.000000,15.827118,64.039825}

/***************************************************************************
	Enumerations :
***************************************************************************/



/***************************************************************************
	Class :
***************************************************************************/








#endif